<div id="new-purchase-order-form">
  <div class="col-md-12">
    <div class="col-md-4 m-b-lg">
      <dl class="dl-horizontal">
        <div class="form-group">
          <dt>供應商</dt>
          <dd>
            <select class="form-control input-sm" v-model="order.partner_id">
              <option selected disabled value="">-- 選取供應商 --</option>
              <option v-for="supplier in suppliers" v-bind:value="supplier.id">{{ supplier.name }}</option>
            </select>
          </dd>
        </div>
      </dl>
    </div>
  </div>

  <hr>

  <div class="col-md-3">
    <dl class="dl-horizontal">
      <div class="form-group">
        <dt>採購單號</dt>
        <dd>自動產生</dd>
      </div>
      <div class="form-group">
        <dt>票據送至</dt>
        <dd>
          <select class="form-control input-sm" v-model="order.bill_to_location_id">
            <option selected disabled value="">-- 選取票據寄送地點 --</option>
            <option v-for="location in locations" v-bind:value="location.id">{{ location.name }}</option>
          </select>
        </dd>
      </div>
      <div class="form-group">
        <dt>貨品送至</dt>
        <dd>
          <select class="form-control input-sm" v-model="order.ship_to_location_id">
            <option selected disabled value="">-- 選取貨品寄送地點 --</option>
            <option v-for="location in stockable_locations" v-bind:value="location.id">{{ location.name }}</option>
          </select>
        </dd>
      </div>
    </dl>
  </div>
  <div class="col-md-3">
    <dl class="dl-horizontal">
      <div class="form-group">
        <dt>收貨日期</dt>
        <dd><input type="date"></dd>
      </div>
      <div class="form-group">
        <dt>Email</dt>
        <dd><input type="text"></dd>
      </div>
      <div class="form-group">
        <dt>收據上傳</dt>
        <dd>施工中...</dd>
      </div>
    </dl>
  </div>
  <div class="col-md-3">
    <dl class="dl-horizontal">
      <div class="form-group">
        <dt>幣別</dt>
        <dd>台幣</dd>
      </div>
      <div class="form-group">
        <dt>價別</dt>
        <dd>
          
        </dd>
      </div>
      <div class="form-group">
        <dt>總金額</dt>
        <dd>稅外/稅入</dd>
      </div>
    </dl>
  </div>

  <div class="col-md-12">
    <%= render 'common/vue_data' %>
  </div>
</div>

<% content_for :js do %>
<script type="text/javascript">
  new Vue({
    el: "#new-purchase-order-form",
    data: {
      order: {},
      suppliers: [],
      locations: [],
      stockable_locations: [],
    },
    ready: function() {
      this.getSupplierList()
      this.getLocationList()
      this.getStockableLocationList()
      this.getPriceList()
    },
    methods: {
      getSupplierList: function() {
        var that = this
        $.ajax({
          url: "/api/v1/suppliers",
          method: "GET",
          dataType: "json"
        }).done(function(data) {
          that.suppliers = data.suppliers
        })
      },
      getLocationList: function() {
        var that = this
        $.ajax({
          url: "/api/v1/locations",
          method: "GET",
          dataType: "json"
        }).done(function(data) {
          that.locations = data.locations
        })
      },
      getStockableLocationList: function() {
        var that = this
        $.ajax({
          url: "/api/v1/locations/holds_stock",
          method: "GET",
          dataType: "json"
        }).done(function(data) {
          that.stockable_locations = data.locations
        })
      },
    }
  })
</script>
<% end %>
